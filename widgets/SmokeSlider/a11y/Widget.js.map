{"version":3,"sources":["../../../../widgets/SmokeSlider/a11y/Widget.js"],"names":["define","lang","on","html","utils","jimuUtils","keys","mo","a11y_init","setAttr","domNode","nls","_widgetLabel","closeBtn","window","jimuNls","common","close","playBtn","previousBtn","nextBtn","pause","previous","next","a11y_firstNode","a11y_lastNode","speedMenu","speedLabelNode","initFirstFocusNode","initLastFocusNode","a11y_open","isInNavMode","isRunInMobile","a11y_shownBy508","setTimeout","hitch","getStyle","noTimeContentNode","focus","a11y_initEvents","own","evt","target","hasClass","baseClass","isInMiniMode","removeClass","_adaptResponsive","keyCode","ENTER","SPACE","TAB","stopPropagation","preventDefault","ESCAPE","emit","cancelable","bubbles","timeContentNode"],"mappings":"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","file":"Widget.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\n// Copyright Â© Esri. All Rights Reserved.\n//\n// Licensed under the Apache License Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n///////////////////////////////////////////////////////////////////////////\n\ndefine([\n  'dojo/_base/lang',\n  'dojo/on',\n  //\"dojo/query\",\n  //\"dojo/aspect\",\n  //'dojo/Deferred',\n  //'dojo/_base/array',\n  'dojo/_base/html',\n  '../utils',\n  'jimu/utils',\n  'dojo/keys'\n  //\"dijit/a11yclick\"\n],\n  function (lang, on, /*query, aspect,Deferred, array,*/html, utils, jimuUtils, keys/*, a11yclick*/) {\n    var mo = {};\n\n    mo.a11y_init = function () {\n      html.setAttr(this.domNode, 'aria-label', this.nls._widgetLabel);\n\n      html.setAttr(this.closeBtn, \"role\", \"button\");\n      html.setAttr(this.closeBtn, \"aria-label\", window.jimuNls.common.close);\n\n      html.setAttr(this.playBtn, \"tabindex\", 0);\n      html.setAttr(this.previousBtn, \"tabindex\", 0);\n      html.setAttr(this.nextBtn, \"tabindex\", 0);\n      html.setAttr(this.playBtn, \"role\", \"button\");\n      html.setAttr(this.playBtn, \"aria-label\", this.nls.pause);\n      html.setAttr(this.previousBtn, \"role\", \"button\");\n      html.setAttr(this.previousBtn, \"aria-label\", this.nls.previous);\n      html.setAttr(this.nextBtn, \"role\", \"button\");\n      html.setAttr(this.nextBtn, \"aria-label\", this.nls.next);\n\n      this.a11y_firstNode = this.previousBtn;\n      this.a11y_lastNode = this.speedMenu.speedLabelNode;\n\n      jimuUtils.initFirstFocusNode(this.domNode, this.a11y_firstNode);\n      jimuUtils.initLastFocusNode(this.domNode, this.a11y_lastNode);\n    };\n\n    mo.a11y_open = function () {\n      if (!jimuUtils.isInNavMode()) {\n        return;\n      }\n      if (!utils.isRunInMobile()) {\n        // this._clearMiniModeTimer();\n        this.a11y_shownBy508 = true;//keep showing\n\n        setTimeout(lang.hitch(this, function () {\n          if(\"none\" !== html.getStyle(this.noTimeContentNode, 'display')){\n            this.closeBtn.focus();//no time data\n          } else {\n            this.playBtn.focus();// play/pause\n          }\n        }), 50);\n      }\n    };\n\n    mo.a11y_initEvents = function () {\n      //domNode\n      this.own(on(this.domNode, 'focus', lang.hitch(this, function (evt) {\n        var target = evt.target;\n        if (!html.hasClass(target, this.baseClass)) {\n          return;\n        }\n        if (!utils.isRunInMobile()) {\n          // this._clearMiniModeTimer();//show all\n        }\n      })));\n      this.own(on(this.domNode, 'blur', lang.hitch(this, function (evt) {\n        var target = evt.target;\n        if (!html.hasClass(target, this.baseClass)) {\n          return;\n        }\n        if (!utils.isRunInMobile()) {\n          // this._setMiniModeTimer();\n          var isInMiniMode = html.hasClass(this.domNode, 'mini-mode');\n          if (isInMiniMode) {\n            html.removeClass(this.domNode, 'mini-mode');\n            this._adaptResponsive();\n          }\n        }\n      })));\n      this.own(on(this.domNode, 'keydown', lang.hitch(this, function (evt) {\n        var target = evt.target;\n        if (html.hasClass(target, this.baseClass) &&\n          (evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE || evt.keyCode === keys.TAB)) {\n\n          if (this.a11y_firstNode && this.a11y_firstNode.focus) {\n            this.a11y_firstNode.focus();\n          }\n        }\n\n        this.a11y_shownBy508 = true;\n      })));\n\n      //closeBtn\n      this.own(on(this.closeBtn, 'keydown', lang.hitch(this, function (evt) {\n        if (evt.keyCode === keys.TAB) {\n          if (this.a11y_firstNode && this.a11y_firstNode.focus) {\n            evt.stopPropagation();\n            evt.preventDefault();\n            //console.log(\"close btn tab\");\n            this.previousBtn.focus();\n          }\n        }\n        if (evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE || evt.keyCode === keys.ESCAPE) {\n          evt.stopPropagation();\n          on.emit(this.closeBtn, 'click', { cancelable: false, bubbles: true });\n        }\n      })));\n      this.own(on(this.closeBtn, 'focus', lang.hitch(this, function (evt) {\n        evt.stopPropagation();\n      })));\n      this.own(on(this.timeContentNode, 'keydown', lang.hitch(this, function (evt) {\n        if (evt.keyCode === keys.ESCAPE) {\n          evt.stopPropagation();\n          this.closeBtn.focus();\n        }\n      })));\n\n      //btns\n      this.own(on(this.playBtn, 'keydown', lang.hitch(this, function (evt) {\n        if (evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE) {\n          evt.stopPropagation();\n          on.emit(this.playBtn, 'click', { cancelable: false, bubbles: true });\n        }\n      })));\n      this.own(on(this.previousBtn, 'keydown', lang.hitch(this, function (evt) {\n        if (evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE) {\n          evt.stopPropagation();\n          on.emit(this.previousBtn, 'click', { cancelable: false, bubbles: true });\n        }\n      })));\n      this.own(on(this.nextBtn, 'keydown', lang.hitch(this, function (evt) {\n        if (evt.keyCode === keys.ENTER || evt.keyCode === keys.SPACE) {\n          evt.stopPropagation();\n          on.emit(this.nextBtn, 'click', { cancelable: false, bubbles: true });\n        }\n      })));\n    };\n\n    return mo;\n  });"]}
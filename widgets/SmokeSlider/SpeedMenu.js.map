{"version":3,"sources":["../../../widgets/SmokeSlider/SpeedMenu.js"],"names":["define","declare","lang","html","array","Evented","_WidgetBase","_TemplatedMixin","_WidgetsInTemplateMixin","template","on","query","jimuUtils","a11y","clazz","baseClass","templateString","nls","menuBox","w","h","_speedList","x025","x05","x1","x15","x2","postCreate","inherited","arguments","_initSpeedMenu","startup","destroy","a11y_init","a11y_initEvents","Object","keys","forEach","hitch","key","dom","str","localizeNumber","innerText","a11y_setAriaLabel","parentElement","parentNode","own","domNode","_closeSpeedMenu","_checks","speedMenu","setSpeed","_onSelectSpeedItem","evt","map","check","addClass","rateStr","optionItem","target","getAttr","removeClass","speedLabelNode","innerHTML","sanitizeHTML","_speed","emit","getSpeed","speed","item","item025","item05","item1","item15","item2","cancelable","bubbles","_setMenuPosition","sPosition","position","y","setStyle","top","bottom","layoutBox","getMarginBox","window","isRTL","x","left","right","_onSpeedLabelClick","stopPropagation","preventDefault","hasClass","_showSpeedMenu","a11y_focusOnSelectedItem","extend"],"mappings":"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","file":"SpeedMenu.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\n// Copyright Â© Esri. All Rights Reserved.\n//\n// Licensed under the Apache License Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n///////////////////////////////////////////////////////////////////////////\n\ndefine(['dojo/_base/declare',\n    'dojo/_base/lang',\n    'dojo/_base/html',\n    'dojo/_base/array',\n    'dojo/Evented',\n    'dijit/_WidgetBase',\n    'dijit/_TemplatedMixin',\n    'dijit/_WidgetsInTemplateMixin',\n    'dojo/text!./SpeedMenu.html',\n    'dojo/on',\n    'dojo/query',\n    'jimu/utils',\n    \"./a11y/SpeedMenu\"\n  ],\n  function (declare, lang, html, array,\n    Evented, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, template,\n    on, query, jimuUtils, a11y) {\n    // box of speed-menu\n\n    var clazz = declare([_WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, Evented], {\n      baseClass: 'speed-container',\n      templateString: template,\n      nls: null,\n      menuBox : {\n        w: 75,\n        h: 120\n      },\n      _speedList: {\n        x025: 0.25,\n        x05: 0.5,\n        x1: 1,\n        x15: 1.5,\n        x2: 2\n      },\n\n      postCreate: function() {\n        this.inherited(arguments);\n        //init speed meun\n        this._initSpeedMenu();\n      },\n\n      startup: function() {\n        this.inherited(arguments);\n      },\n\n      destroy: function(){\n        this.inherited(arguments);\n      },\n\n      _initSpeedMenu: function(){\n        this.a11y_init();\n        this.a11y_initEvents();\n\n        Object.keys(this._speedList).forEach(lang.hitch(this, function (key) {\n          var dom = this[key];\n          var str = jimuUtils.localizeNumber(this._speedList[key]) + \"x\";\n          dom.innerText = str;\n          this.a11y_setAriaLabel(dom.parentElement || dom.parentNode, str);\n        }));\n\n        this.own(on(this.domNode, 'click', lang.hitch(this, this._closeSpeedMenu)));\n        this._checks = query(\".check\", this.speedMenu);\n\n        this.setSpeed(\"1\");//init display\n      },\n\n      _onSelectSpeedItem: function(evt) {\n        array.map(this._checks, lang.hitch(this, function (check) {\n          html.addClass(check, 'hide');\n        }));\n\n        var rateStr, optionItem;\n        if (evt.target) {\n          rateStr = html.getAttr(evt.target, 'data-speed');\n          if (rateStr) {\n            optionItem = evt.target;\n          } else {\n            optionItem = evt.target.parentNode;//click on checked icon\n            rateStr = html.getAttr(optionItem, 'data-speed');\n          }\n        }\n        if (optionItem) {\n          var check = query(\".check\", optionItem)[0];\n          if (check) {\n            html.removeClass(check, 'hide');\n          }\n          this.speedLabelNode.innerHTML = jimuUtils.sanitizeHTML(optionItem.innerText);\n\n          this._speed = rateStr;\n          this.emit(\"selected\", rateStr);\n        }\n      },\n\n      getSpeed: function () {\n        return this._speed;\n      },\n      setSpeed: function (speed) {\n        var item = null;\n        switch (speed) {\n          case \"0.25\": {\n            item = this.item025; break;\n          } case \"0.5\": {\n            item = this.item05; break;\n          } case \"1\": {\n            item = this.item1; break;\n          } case \"1.5\": {\n            item = this.item15; break;\n          } case \"2\": {\n            item = this.item2; break;\n          } default: {\n            item = null;\n          }\n        }\n        if (item) {\n          on.emit(item, 'click', { cancelable: false, bubbles: true });\n        }\n      },\n\n      //speed menu\n      _setMenuPosition: function() {\n        var sPosition = html.position(this.speedLabelNode);\n        if (sPosition.y - this.menuBox.h - 2 < 0) {\n          html.setStyle(this.speedMenu, {\n            top: '27px',\n            bottom: 'auto'\n          });\n        }\n\n        var layoutBox = html.getMarginBox(this.domNode);\n        if (window.isRTL) {\n          if (sPosition.x - this.menuBox.w < 0) {\n            html.setStyle(this.speedMenu, {\n              left: 0\n            });\n          }\n        } else {\n          if (sPosition.x + this.menuBox.w > layoutBox.w) {\n            html.setStyle(this.speedMenu, {\n              right: 0\n            });\n          }\n        }\n      },\n\n      _onSpeedLabelClick: function(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n\n        if(html.hasClass(this.speedMenu, \"hide\")){\n          this._setMenuPosition();\n          this._showSpeedMenu();\n        } else {\n          this._closeSpeedMenu();\n        }\n      },\n\n      _showSpeedMenu: function() {\n        html.removeClass(this.speedMenu, \"hide\");\n        this.emit(\"open\");\n\n        this.a11y_focusOnSelectedItem();\n      },\n\n      _closeSpeedMenu: function() {\n        html.addClass(this.speedMenu, \"hide\");\n        this.emit(\"close\");\n      }\n\n    });\n\n    clazz.extend(a11y);//for a11y\n    return clazz;\n  });"]}
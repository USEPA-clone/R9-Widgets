{"version":3,"sources":["../../../../widgets/SmokeSlider/setting/TimeCalendar.js"],"names":["define","Evented","declare","lang","html","_WidgetBase","_TemplatedMixin","_WidgetsInTemplateMixin","on","template","utils","DateTextBox","TimeTextBox","Select","clazz","templateString","_KEEP_VALUE_FLAG","postCreate","_timeModeOptions","nls","time","now","today","maxOptions","maximum","minOptions","minimum","mode","push","_operatorOptions","modeOptions","options","modeSelector","own","hitch","val","toggleTimeMode","_setKeepValueFlag","dateBox","dateBoxContainer","startup","timeTextBox","timeTextBoxContainer","_updateTimeModeValue","operatorSelector","operatorContainer","unit","intervalUnitOptions","unitContainer","numberSpinner","maxminDateBox","maxminDateBoxContainer","maxminTimeTextBox","maxminTimeTextBoxContainer","inherited","arguments","emit","isTriggerEvent","addClass","calenderMode","timeMode","maxminMode","_isTriggerEvent","set","removeClass","_getKeepValueFlag","_getMaxOrMinTime","timeExtent","parent","getLayersTimeExtent","setMaxMinTime","config","startTime","endTime","Date","isValid","getValue","setConfig","keepValueFlag","calender","operator","number","getConfig","date","fullDate","calenderConfig","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","flag"],"mappings":"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","file":"TimeCalendar.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\n// Copyright Â© Esri. All Rights Reserved.\n//\n// Licensed under the Apache License Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n///////////////////////////////////////////////////////////////////////////\n\ndefine(['dojo/Evented',\n  'dojo/_base/declare',\n  'dojo/_base/lang',\n  'dojo/_base/html',\n  'dijit/_WidgetBase',\n  'dijit/_TemplatedMixin',\n  \"dijit/_WidgetsInTemplateMixin\",\n  'dojo/on',\n  \"dojo/text!./TimeCalendar.html\",\n  \"../utils\",\n  \"dijit/form/DateTextBox\",\n  \"dijit/form/TimeTextBox\",\n  \"dijit/form/Select\",\n  \"dijit/form/NumberSpinner\",\n  \"dijit/form/ValidationTextBox\",\n  \"jimu/dijit/CheckBox\"\n],\n  function (Evented, declare, lang, html,\n    _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin,\n    on, template, utils,\n    DateTextBox, TimeTextBox, Select) {\n    var clazz = declare([Evented, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin], {\n      templateString: template,\n      /*\n      configFromat = {\n        timeMode:\"time\", //\"time\",\"now\",\"today\"\n        time:\"\",//computer time\n        calender:{\n          operator:\"\",// + / -\n          number:\"\",//number\n          unit:\"\"//esriTimeInfo.X\n        }\n      }\n      */\n      _KEEP_VALUE_FLAG: false,//set true, afer user change any setting\n\n      postCreate: function () {\n        this._timeModeOptions = [{\n          \"label\": this.nls.time,\n          \"value\": \"time\"\n        }, {\n          \"label\": this.nls.now,\n          \"value\": \"now\"\n        }, {\n          \"label\": this.nls.today,\n          \"value\": \"today\"\n        }];\n        var maxOptions = {\n          \"label\": this.nls.maximum,\n          \"value\": \"max\"\n        };\n        var minOptions = {\n          \"label\": this.nls.minimum,\n          \"value\": \"min\"\n        };\n\n        if (this.mode === \"min\") {\n          this._timeModeOptions.push(minOptions);\n        } else if (this.mode === \"max\") {\n          this._timeModeOptions.push(maxOptions);\n        }\n\n        this._operatorOptions = [{\n          \"label\": \"+\",\n          \"value\": \"+\"\n        }, {\n          \"label\": \"-\",\n          \"value\": \"-\"\n        }];\n\n        //0 mode\n        this.modeOptions = new Select({\n          options: this._timeModeOptions,\n          \"class\": \"calendar-inputs\"\n        }, this.modeSelector);\n        this.own(on(this.modeOptions, \"change\", lang.hitch(this, function (val) {\n          this.toggleTimeMode(val, false);\n          if (val !== \"max\" || val !== \"min\") {\n            this._setKeepValueFlag(true);\n          }\n        })));\n        //1 time\n        this.dateBox = new DateTextBox({\n          \"class\": \"calendar-inputs\"\n        }, this.dateBoxContainer);\n        this.dateBox.startup();\n        this.timeTextBox = new TimeTextBox({\n          \"class\": \"calendar-inputs time-inputs\"\n        }, this.timeTextBoxContainer);\n        this.timeTextBox.startup();\n\n        this._updateTimeModeValue();\n\n        this.own(on(this.dateBox, \"change\", lang.hitch(this, function () {\n          this._setKeepValueFlag(true);\n        })));\n        this.own(on(this.timeTextBox, \"change\", lang.hitch(this, function () {\n          this._setKeepValueFlag(true);\n        })));\n        //2 calender\n        this.operatorSelector = new Select({\n          options: this._operatorOptions,\n          \"class\": \"calendar-operator\"\n        }, this.operatorContainer);\n        this.unit = new Select({\n          options: utils.intervalUnitOptions,\n          \"class\": \"calendar-inputs\"\n        }, this.unitContainer);\n\n        this.own(on(this.operatorSelector, \"change\", lang.hitch(this, function () {\n          this._setKeepValueFlag(true);\n        })));\n        this.own(on(this.numberSpinner, \"change\", lang.hitch(this, function () {\n          this._setKeepValueFlag(true);\n        })));\n        this.own(on(this.unit, \"change\", lang.hitch(this, function () {\n          this._setKeepValueFlag(true);\n        })));\n        //3 maxmin\n        this.maxminDateBox = new DateTextBox({\n          'readonly': 'readonly',\n          \"class\": \"calendar-inputs\",\n          \"disabled\": true\n        }, this.maxminDateBoxContainer);\n        this.maxminDateBox.startup();\n        this.maxminTimeTextBox = new TimeTextBox({\n          'readonly': 'readonly',\n          \"class\": \"calendar-inputs\",\n          \"disabled\": true\n        }, this.maxminTimeTextBoxContainer);\n        this.maxminTimeTextBox.startup();\n\n        this.inherited(arguments);\n      },\n\n      startup: function () {\n        if (this.mode === \"min\" || this.mode === \"max\") {\n          this.toggleTimeMode(this.mode, false);//init last one\n        }\n\n        this.inherited(arguments);\n\n        this.emit(\"haveloaded\");//to update interval\n      },\n\n      toggleTimeMode: function (mode, isTriggerEvent) {\n        html.addClass(this.calenderMode, \"hide\");\n        html.addClass(this.timeMode, \"hide\");\n        html.addClass(this.maxminMode, \"hide\");\n\n        var _isTriggerEvent = false;\n        if (isTriggerEvent === true) {\n          _isTriggerEvent = true;\n        }\n        this.modeOptions.set(\"value\", mode, _isTriggerEvent);\n\n        if (mode === \"time\") {\n          html.removeClass(this.timeMode, \"hide\");\n\n          if (this._getKeepValueFlag()) {\n            return;\n          }\n          this._updateTimeModeValue();\n        } else if (mode === \"max\" || mode === \"min\") {\n          html.removeClass(this.maxminMode, \"hide\");\n          this._getMaxOrMinTime();\n        } else {//\"now\",\"today\"\n          html.removeClass(this.calenderMode, \"hide\");\n        }\n      },\n\n      _getMaxOrMinTime: function () {\n        var timeExtent = this.parent.getLayersTimeExtent();\n        if (timeExtent) {\n          this.setMaxMinTime(timeExtent);\n        }\n      },\n      setMaxMinTime: function (config) {\n        var time;\n        if (this.mode === \"min\") {\n          time = config.timeExtent.startTime;\n        } else if (this.mode === \"max\") {\n          time = config.timeExtent.endTime;\n        }\n\n        this.maxminDateBox.set(\"value\", new Date(time), false);\n        this.maxminTimeTextBox.set(\"value\", new Date(time), false);\n      },\n      isValid: function () {\n        if (this.modeOptions.getValue() === \"time\") {\n          return (this.dateBox.isValid() && this.timeTextBox.isValid());\n        } else if (this.modeOptions.getValue() === \"max\" || this.modeOptions.getValue() === \"min\") {\n          return (this.maxminDateBox.isValid() && this.maxminTimeTextBox.isValid());\n        } else {\n          //now today\n          return (this.operatorSelector.isValid() && this.numberSpinner.isValid() && this.unit.isValid());\n        }\n      },\n      setConfig: function (config) {\n        if (this._getKeepValueFlag()) {\n          // max/min mode ignore keepValueFalg\n          if (config.time) {\n            this.maxminDateBox.set(\"value\", new Date(config.time), false);\n            this.maxminTimeTextBox.set(\"value\", new Date(config.time), false);\n          }\n          return;//read only\n        }\n\n        if (config.keepValueFlag) {\n          this._KEEP_VALUE_FLAG = config.keepValueFlag;\n        }\n\n        if (config.timeMode) {\n          this.toggleTimeMode(config.timeMode, false);\n        }\n\n        if (config.time) {\n          this.dateBox.set(\"value\", new Date(config.time), false);\n          this.timeTextBox.set(\"value\", new Date(config.time), false);\n          //update max/min in the same time\n          this.maxminDateBox.set(\"value\", new Date(config.time), false);\n          this.maxminTimeTextBox.set(\"value\", new Date(config.time), false);\n        }\n\n        if (config.calender) {\n          if (\"undefined\" === typeof config.calender.operator || \"\" === config.calender.operator) {\n            config.calender.operator = \"+\";//default value\n          }\n          this.operatorSelector.set(\"value\", config.calender.operator, false);\n          this.numberSpinner.set(\"value\", config.calender.number, false);\n          this.unit.set(\"value\", config.calender.unit, false);\n        }\n      },\n      getConfig: function () {\n        var date, time, fullDate;\n        var calenderConfig = {\n          operator: \"\",// + / -\n          number: \"\",//number\n          unit: \"\"//esriTimeInfo.X\n        };\n\n        if (this.modeOptions.getValue() === \"time\") {\n          date = this.dateBox.getValue();\n          time = this.timeTextBox.getValue();\n\n          if (date && time) {\n            //new Date( year, month, date, hrs, min, sec)\n            fullDate = new Date(date.getFullYear(), date.getMonth(), date.getDate(),\n              time.getHours(), time.getMinutes(), time.getSeconds());\n          } else {\n            fullDate = null;\n          }\n        } else if (this.modeOptions.getValue() === \"max\" || this.modeOptions.getValue() === \"min\") {\n          date = this.maxminDateBox.getValue();\n          time = this.maxminTimeTextBox.getValue();\n\n          if (date && time) {\n            //new Date( year, month, date, hrs, min, sec)\n            fullDate = new Date(date.getFullYear(), date.getMonth(), date.getDate(),\n              time.getHours(), time.getMinutes(), time.getSeconds());\n          } else {\n            fullDate = null;\n          }\n        } else {//now today\n          //if (this.modeOptions.getValue() !== \"time\") {\n          calenderConfig = {\n            operator: this.operatorSelector.getValue(),// + / -\n            number: this.numberSpinner.getValue(),//number\n            unit: this.unit.getValue()//esriTimeInfo.X\n          };\n        }\n\n        var config = {\n          keepValueFlag: this._getKeepValueFlag(),\n          timeMode: this.modeOptions.getValue(), //true or false\n          time: fullDate,//computer time\n          calender: calenderConfig\n        };\n        return config;\n      },\n\n      _updateTimeModeValue: function () {\n        this.dateBox.set(\"value\", new Date(), false);\n        this.timeTextBox.set(\"value\", new Date(), false);\n      },\n\n      //read only falg\n      _setKeepValueFlag: function (flag) {\n        this._KEEP_VALUE_FLAG = flag;\n\n        this.emit(\"change\");\n      },\n      _getKeepValueFlag: function () {\n        return !!this._KEEP_VALUE_FLAG;\n      }\n    });\n    return clazz;\n  });"]}
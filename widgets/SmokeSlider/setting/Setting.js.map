{"version":3,"sources":["../../../../widgets/SmokeSlider/setting/Setting.js"],"names":["define","declare","BaseWidgetSetting","_WidgetsInTemplateMixin","on","lang","html","keys","Deferred","jimuUtils","ConfigureTimeSettings","Popup","CheckBox","Select","baseClass","configureTimeSettings","postCreate","_timeFormatOptions","nls","mapDefault","custom","showLabelsBox","label","showLayerLabels","checked","startup","autoPlay","loopPlay","timeFormat","options","inherited","arguments","config","customDateFormat","setAttribute","own","hitch","_firstChange","val","_initOptionsUI","webMapSettingRaido","_updateTimeSettingBtnUI","configureSettingRaido","setConfig","customDateFormatVal","addClass","customDateContainer","set","removeClass","timeSettingBtn","_createTimeConfigSetting","then","isDisableOk","popup","titleLabel","timeSetting","autoHeight","content","container","width","buttons","window","jimuNls","common","ok","key","ENTER","disable","onClick","cancel","classNames","ESCAPE","onClose","domNode","_onPopupOk","isValid","getConfig","close","_onPopupClose","showLabels","setValue","customDateFormatValue","isHonorWebMap","setChecked","getValue","get","focus","_onCustomDateFormatBlur","value","stripHTML","def","map","configureTimeSettingsContainer","ops","isNoLayer","resolve"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,OAAO,CACL,oBADK,EAEL,wBAFK,EAGL,+BAHK,EAIL,SAJK,EAKL,iBALK,EAML,iBANK,EAOL,WAPK,EAQL,eARK,EASL,YATK,EAUL,yBAVK;AAWL;AACA,kBAZK,EAaL,qBAbK,EAcL,mBAdK,EAeL,8BAfK,CAAP,EAiBE,UACEC,OADF,EACWC,iBADX,EAC8BC,uBAD9B,EAEEC,EAFF,EAEMC,IAFN,EAEYC,IAFZ,EAEkBC,IAFlB,EAEwBC,QAFxB,EAGEC,SAHF,EAGaC,qBAHb,EAGoC,iBAAiBC,KAHrD,EAIEC,QAJF,EAIYC,MAJZ,CAIkB,uBAJlB,EAI2C;AACzC,SAAOZ,QAAQ,CAACC,iBAAD,EAAoBC,uBAApB,CAAR,EAAsD;AAC3DW,eAAW,gCADgD;AAE3DC,2BAAuB,IAFoC;AAG3D;;;;;;;;;;;;AAcAC,gBAAY,sBAAY;AACtB,WAAKC,kBAAL,GAA0B,CAAC;AACzB,iBAAS,KAAKC,GAAL,CAASC,UADO;AAEzB,iBAAS;AAFgB,OAAD,EAGvB;AACD,iBAAS,WADR;AAED,iBAAS;AAFR,OAHuB,EAMvB;AACD,iBAAS,UADR;AAED,iBAAS;AAFR,OANuB,EASvB;AACD,iBAAS,cADR;AAED,iBAAS;AAFR,OATuB,EAYvB;AACD,iBAAS,iBADR;AAED,iBAAS;AAFR,OAZuB,EAevB;AACD,iBAAS,WADR;AAED,iBAAS;AAFR,OAfuB,EAkBvB;AACD,iBAAS,WADR;AAED,iBAAS;AAFR,OAlBuB,EAqBvB;AACD,iBAAS,SADR;AAED,iBAAS;AAFR,OArBuB,EAwBvB;AACD,iBAAS,MADR;AAED,iBAAS;AAFR,OAxBuB,EA2BvB;AACD,iBAAS,mBADR;AAED,iBAAS;AAFR,OA3BuB,EA8BvB;AACD,iBAAS,oBADR;AAED,iBAAS;AAFR,OA9BuB,EAiCvB;AACD,iBAAS,KAAKD,GAAL,CAASE,MADjB;AAED,iBAAS;AAFR,OAjCuB,CAA1B;;AAsCA,WAAKC,aAAL,GAAqB,IAAIT,QAAJ,CAAa;AAChCU,eAAO,KAAKJ,GAAL,CAASK,eADgB;AAEhCC,iBAAS;AAFuB,OAAb,EAGlB,KAAKH,aAHa,CAArB;AAIA,WAAKA,aAAL,CAAmBI,OAAnB;;AAEA,WAAKC,QAAL,GAAgB,IAAId,QAAJ,CAAa;AAC3BU,eAAO,KAAKJ,GAAL,CAASQ,QADW;AAE3BF,iBAAS;AAFkB,OAAb,EAGb,KAAKE,QAHQ,CAAhB;AAIA,WAAKA,QAAL,CAAcD,OAAd;;AAEA,WAAKE,QAAL,GAAgB,IAAIf,QAAJ,CAAa;AAC3BU,eAAO,KAAKJ,GAAL,CAASS,QADW;AAE3BH,iBAAS;AAFkB,OAAb,EAGb,KAAKG,QAHQ,CAAhB;AAIA,WAAKA,QAAL,CAAcF,OAAd;;AAEA,WAAKG,UAAL,GAAkB,IAAIf,MAAJ,CAAW;AAC3BgB,iBAAS,KAAKZ;AADa,OAAX,EAEf,KAAKW,UAFU,CAAlB;;AAIA,WAAKE,SAAL,CAAeC,SAAf;AACD,KA/E0D;;AAiF3DN,aAAS,mBAAY;AACnB,UAAI,CAAC,KAAKO,MAAV,EAAkB;AAChB,aAAKA,MAAL,GAAc,EAAd;AACD;;AAED,WAAKC,gBAAL,CAAsBC,YAAtB,CAAmC,aAAnC,EAAkD,oBAAlD;;AAEA,WAAKC,GAAL,CAAS/B,GAAG,KAAKwB,UAAR,EAAoB,OAApB,EAA6BvB,KAAK+B,KAAL,CAAW,IAAX,EAAiB,YAAY;AACjE,YAAI,gBAAgB,OAAO,KAAKC,YAAhC,EAA8C;AAC5C,eAAKA,YAAL,GAAoB,KAApB;AACD;AACF,OAJqC,CAA7B,CAAT;AAKA,WAAKF,GAAL,CAAS/B,GAAG,KAAKwB,UAAR,EAAoB,QAApB,EAA8BvB,KAAK+B,KAAL,CAAW,IAAX,EAAiB,UAAUE,GAAV,EAAe;AACrE,YAAI,gBAAgB,OAAO,KAAKD,YAAhC,EAA8C;AAC5C,eAAKA,YAAL,GAAoB,KAApB;AACD,SAFD,MAEO;AACL,eAAKE,cAAL,CAAoBD,GAApB;AACD;AACF,OANsC,CAA9B,CAAT;;AAQA,WAAKH,GAAL,CAAS/B,GAAG,KAAKoC,kBAAR,EAA4B,QAA5B,EAAsCnC,KAAK+B,KAAL,CAAW,IAAX,EAAiB,YAAY;AAC1E,aAAKK,uBAAL;AACD,OAF8C,CAAtC,CAAT;AAGA,WAAKN,GAAL,CAAS/B,GAAG,KAAKsC,qBAAR,EAA+B,QAA/B,EAAyCrC,KAAK+B,KAAL,CAAW,IAAX,EAAiB,YAAY;AAC7E,aAAKK,uBAAL;AACD,OAFiD,CAAzC,CAAT;;AAIA;AACA;AACA;AACA;AACA;;AAEA,WAAKE,SAAL,CAAe,KAAKX,MAApB;AACA,WAAKF,SAAL,CAAeC,SAAf;AACD,KApH0D;;AAsH3DQ,oBAAgB,wBAAUD,GAAV,EAAeM,mBAAf,EAAoC;AAClD,UAAIN,QAAQ,QAAZ,EAAsB;AACpBhC,aAAKuC,QAAL,CAAc,KAAKC,mBAAnB,EAAwC,MAAxC;AACA,aAAKb,gBAAL,CAAsBc,GAAtB,CAA0B,OAA1B,EAAmC,EAAnC;AACD,OAHD,MAGO;AACLzC,aAAK0C,WAAL,CAAiB,KAAKF,mBAAtB,EAA2C,MAA3C;AACA,aAAKb,gBAAL,CAAsBc,GAAtB,CAA0B,OAA1B,EAAmCH,uBAAuB,EAA1D;AACD;;AAED;AACA,WAAKT,GAAL,CAAS/B,GAAG,KAAK6C,cAAR,EAAwB,OAAxB,EAAiC5C,KAAK+B,KAAL,CAAW,IAAX,EAAiB,YAAY;AACrE,YAAI,CAAC,KAAKM,qBAAL,CAA2BlB,OAAhC,EAAyC;AACvC;AACD;;AAED,aAAK0B,wBAAL,GAAgCC,IAAhC,CAAqC9C,KAAK+B,KAAL,CAAW,IAAX,EAAiB,UAAUgB,WAAV,EAAuB;AAC3E,eAAKC,KAAL,GAAa,IAAI1C,KAAJ,CAAU;AACrB2C,wBAAY,KAAKpC,GAAL,CAASqC,WADA;AAErBC,wBAAY,IAFS;AAGrBC,qBAAS,KAAK1C,qBAHO;AAIrB2C,uBAAW,WAJU;AAKrBC,mBAAO,GALc;AAMrBC,qBAAS,CAAC;AACRtC,qBAAOuC,OAAOC,OAAP,CAAeC,MAAf,CAAsBC,EADrB;AAERC,mBAAK1D,KAAK2D,KAFF;AAGRC,uBAASf,WAHD;AAIRgB,uBAAS/D,KAAK+B,KAAL,CAAW,IAAX,EAAiB,YAAjB;AAJD,aAAD,EAKN;AACDd,qBAAOuC,OAAOC,OAAP,CAAeC,MAAf,CAAsBM,MAD5B;AAEDC,0BAAY,CAAC,mBAAD,CAFX;AAGDL,mBAAK1D,KAAKgE;AAHT,aALM,CANY;AAgBrBC,qBAASnE,KAAK+B,KAAL,CAAW,IAAX,EAAiB,eAAjB;AAhBY,WAAV,CAAb;AAkBA9B,eAAKuC,QAAL,CAAc,KAAKQ,KAAL,CAAWoB,OAAzB,EAAkC,iCAAlC;AACD,SApBoC,CAArC;AAqBD,OA1ByC,CAAjC,CAAT;AA2BD,KA3J0D;;AA6J3DC,gBAAY,sBAAY;AACtB,UAAI,UAAU,KAAK3D,qBAAL,CAA2B4D,OAA3B,EAAd,EAAoD;AAClD,eAAO,KAAP,CADkD,CACrC;AACd;AACD,WAAK3C,MAAL,GAAc,KAAKjB,qBAAL,CAA2B6D,SAA3B,CAAqC,KAAK5C,MAA1C,CAAd;;AAEA,WAAKqB,KAAL,CAAWwB,KAAX;AACA,WAAK9D,qBAAL,GAA6B,IAA7B;AACA,WAAKsC,KAAL,GAAa,IAAb;AACD,KAtK0D;;AAwK3DyB,mBAAe,yBAAY;AACzB,WAAK/D,qBAAL,GAA6B,IAA7B;AACA,WAAKsC,KAAL,GAAa,IAAb;AACD,KA3K0D;;AA6K3DV,eAAW,mBAAUX,MAAV,EAAkB;AAC3B,WAAKA,MAAL,GAAcA,MAAd;;AAEA,UAAIA,OAAO+C,UAAX,EAAuB;AACrB,aAAK1D,aAAL,CAAmB2D,QAAnB,CAA4B,IAA5B;AACD,OAFD,MAEO;AACL,aAAK3D,aAAL,CAAmB2D,QAAnB,CAA4B,KAA5B;AACD;;AAED,UAAI,UAAUhD,OAAON,QAArB,EAA+B;AAC7B,aAAKA,QAAL,CAAcsD,QAAd,CAAuB,KAAvB;AACD,OAFD,MAEO;AACL,aAAKtD,QAAL,CAAcsD,QAAd,CAAuB,IAAvB,EADK,CACwB;AAC9B;;AAED,UAAI,UAAUhD,OAAOL,QAArB,EAA+B;AAC7B,aAAKA,QAAL,CAAcqD,QAAd,CAAuB,KAAvB;AACD,OAFD,MAEO;AACL,aAAKrD,QAAL,CAAcqD,QAAd,CAAuB,IAAvB,EADK,CACwB;AAC9B;;AAED,UAAIhD,OAAOJ,UAAX,EAAuB;AACrB,aAAKA,UAAL,CAAgBoD,QAAhB,CAAyBhD,OAAOJ,UAAhC;;AAEA,YAAIqD,qBAAJ;AACA,YAAIjD,OAAOC,gBAAX,EAA6B;AAC3BgD,kCAAwBjD,OAAOC,gBAA/B;AACD;AACD,aAAKM,cAAL,CAAoBP,OAAOJ,UAA3B,EAAuCqD,qBAAvC;AACD,OARD,MAQO;AACL,aAAKrD,UAAL,CAAgBoD,QAAhB,CAAyB,MAAzB;AACD;;AAED;AACA;AACA;;AAEA,UAAI,gBAAgB,OAAOhD,OAAOkD,aAA9B,IAA+C,SAASlD,OAAOkD,aAAnE,EAAkF;AAChFlD,eAAOkD,aAAP,GAAuB,IAAvB;AACA,aAAK1C,kBAAL,CAAwB2C,UAAxB,CAAmC,IAAnC;AACD,OAHD,MAGO;AACLnD,eAAOkD,aAAP,GAAuB,KAAvB;AACA,aAAKxC,qBAAL,CAA2ByC,UAA3B,CAAsC,IAAtC;AACD;AACD,WAAK1C,uBAAL;AACD,KA1N0D;;AA4N3DmC,eAAW,qBAAY;AACrB,UAAI,aAAa,KAAKhD,UAAL,CAAgBwD,QAAhB,EAAb,IAA2C,OAAO,KAAKnD,gBAAL,CAAsBoD,GAAtB,CAA0B,OAA1B,CAAtD,EAA0F;AACxF,aAAKpD,gBAAL,CAAsBqD,KAAtB;AACA,aAAKrD,gBAAL,CAAsBc,GAAtB,CAA0B,OAA1B,EAAmC,OAAnC;AACA,eAAO,KAAP;AACD;;AAED,WAAKf,MAAL,CAAY+C,UAAZ,GAAyB,KAAK1D,aAAL,CAAmB+D,QAAnB,EAAzB;AACA,WAAKpD,MAAL,CAAYN,QAAZ,GAAuB,KAAKA,QAAL,CAAc0D,QAAd,EAAvB;AACA,WAAKpD,MAAL,CAAYL,QAAZ,GAAuB,KAAKA,QAAL,CAAcyD,QAAd,EAAvB;AACA,WAAKpD,MAAL,CAAYJ,UAAZ,GAAyB,KAAKA,UAAL,CAAgBwD,QAAhB,EAAzB;;AAEA,UAAI,KAAKnD,gBAAL,CAAsBoD,GAAtB,CAA0B,OAA1B,CAAJ,EAAwC;AACtC,aAAKrD,MAAL,CAAYC,gBAAZ,GAA+B,KAAKA,gBAAL,CAAsBoD,GAAtB,CAA0B,OAA1B,CAA/B;AACD,OAFD,MAEO;AACL,aAAKrD,MAAL,CAAYC,gBAAZ,GAA+B,EAA/B;AACD;;AAED;AACA;AACA;;AAEA,UAAI,KAAKO,kBAAL,CAAwBhB,OAA5B,EAAqC;AACnC,aAAKQ,MAAL,CAAYkD,aAAZ,GAA4B,IAA5B;AACD,OAFD,MAEO;AAAC;AACN,aAAKlD,MAAL,CAAYkD,aAAZ,GAA4B,KAA5B;AACD;;AAED,UAAI,CAAC,KAAKnE,qBAAV,EAAiC;AAC/B,aAAKmC,wBAAL;AACD;AACD,UAAI,KAAKnC,qBAAL,IAA8B,KAAKA,qBAAL,CAA2B6D,SAA7D,EAAwE;AACtE,aAAK5C,MAAL,GAAc,KAAKjB,qBAAL,CAA2B6D,SAA3B,CAAqC,KAAK5C,MAA1C,CAAd;AACD;;AAED,aAAO,KAAKA,MAAZ;AACD,KAhQ0D;;AAkQ3DuD,6BAAyB,mCAAY;AACnC,WAAKtD,gBAAL,CAAsBuD,KAAtB,GAA8B/E,UAAUgF,SAAV,CAAoB,KAAKxD,gBAAL,CAAsBuD,KAAtB,IAA+B,EAAnD,CAA9B;AACD,KApQ0D;AAqQ3D/C,6BAAyB,mCAAY;AACnC,UAAI,KAAKD,kBAAL,CAAwBhB,OAA5B,EAAqC;AACnClB,aAAKuC,QAAL,CAAc,KAAKI,cAAnB,EAAmC,UAAnC;AACD;AACD,UAAI,KAAKP,qBAAL,CAA2BlB,OAA/B,EAAwC;AACtClB,aAAK0C,WAAL,CAAiB,KAAKC,cAAtB,EAAsC,UAAtC;AACD;AACF,KA5Q0D;AA6Q3D;AACAC,8BAA0B,oCAAY;AACpC,UAAIwC,MAAM,IAAIlF,QAAJ,EAAV;AACA,WAAKO,qBAAL,GAA6B,IAAIL,qBAAJ,CAA0B;AACrDQ,aAAK,KAAKA,GAD2C;AAErDyE,aAAK,KAAKA,GAF2C;AAGrD3D,gBAAQ,KAAKA;AAHwC,OAA1B,EAI1B,KAAK4D,8BAJqB,CAA7B;AAKA,WAAKzD,GAAL,CAAS/B,GAAG,KAAKW,qBAAR,EAA+B,cAA/B,EAA+CV,KAAK+B,KAAL,CAAW,IAAX,EAAiB,UAAUyD,GAAV,EAAe;AACtF,YAAIzC,cAAc,KAAlB;AACA,YAAIyC,OAAOA,IAAIC,SAAf,EAA0B;AACxB1C,wBAAc,IAAd;AACD;;AAEDsC,YAAIK,OAAJ,CAAY3C,WAAZ;AACD,OAPuD,CAA/C,CAAT;AAQA,WAAKrC,qBAAL,CAA2BU,OAA3B;;AAEA,aAAOiE,GAAP;AACD;AAhS0D,GAAtD,CAAP;AAkSD,CAxTH","file":"Setting.js","sourcesContent":["///////////////////////////////////////////////////////////////////////////\n// Copyright Â© Esri. All Rights Reserved.\n//\n// Licensed under the Apache License Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n///////////////////////////////////////////////////////////////////////////\n\ndefine([\n  'dojo/_base/declare',\n  'jimu/BaseWidgetSetting',\n  'dijit/_WidgetsInTemplateMixin',\n  'dojo/on',\n  'dojo/_base/lang',\n  'dojo/_base/html',\n  'dojo/keys',\n  'dojo/Deferred',\n  'jimu/utils',\n  './ConfigureTimeSettings',\n  //'./AutoRefresh',\n  'jimu/dijit/Popup',\n  \"jimu/dijit/CheckBox\",\n  \"dijit/form/Select\",\n  \"dijit/form/ValidationTextBox\"\n],\n  function (\n    declare, BaseWidgetSetting, _WidgetsInTemplateMixin,\n    on, lang, html, keys, Deferred,\n    jimuUtils, ConfigureTimeSettings, /*AutoRefresh, */Popup,\n    CheckBox, Select/* ,ValidationTextBox*/) {\n    return declare([BaseWidgetSetting, _WidgetsInTemplateMixin], {\n      baseClass: 'jimu-widget-timeslider-setting',\n      configureTimeSettings: null,\n      /*\n        configFormat = {\n          showLabels : true,//t/f\n          autoPlay :true,//t/f\n          loopPlay: true,//t/f\n          timeFormat:\"\",//by selector\n          customDateFormat:\"\",//string / \"\",\n\n          isHonorWebMap: true,//false\n\n          customLayersConfig:{},\n          customTimeConfig:{}\n        }\n      */\n      postCreate: function () {\n        this._timeFormatOptions = [{\n          \"label\": this.nls.mapDefault,\n          \"value\": \"auto\"\n        }, {\n          \"label\": \"July 2015\",\n          \"value\": \"MMMM YYYY\"\n        }, {\n          \"label\": \"Jul 2015\",\n          \"value\": \"MMM YYYY\"\n        }, {\n          \"label\": \"July 21,2015\",\n          \"value\": \"MMMM D,YYYY\"\n        }, {\n          \"label\": \"Tue Jul 21,2015\",\n          \"value\": \"ddd MMM DD,YYYY\"\n        }, {\n          \"label\": \"7/21/2015\",\n          \"value\": \"M/DD/YYYY\"\n        }, {\n          \"label\": \"2015/7/21\",\n          \"value\": \"YYYY/M/DD\"\n        }, {\n          \"label\": \"7/21/15\",\n          \"value\": \"M/DD/YY\"\n        }, {\n          \"label\": \"2015\",\n          \"value\": \"YYYY\"\n        }, {\n          \"label\": \"7/21/2015 8:00 am\",\n          \"value\": \"M/DD/YYYY  h:mm a\"\n        }, {\n          \"label\": \"Tue Jul 21 8:00 am\",\n          \"value\": \"ddd MMM DD  h:mm a\"\n        }, {\n          \"label\": this.nls.custom,\n          \"value\": \"Custom\"\n        }];\n\n        this.showLabelsBox = new CheckBox({\n          label: this.nls.showLayerLabels,\n          checked: false\n        }, this.showLabelsBox);\n        this.showLabelsBox.startup();\n\n        this.autoPlay = new CheckBox({\n          label: this.nls.autoPlay,\n          checked: false\n        }, this.autoPlay);\n        this.autoPlay.startup();\n\n        this.loopPlay = new CheckBox({\n          label: this.nls.loopPlay,\n          checked: false\n        }, this.loopPlay);\n        this.loopPlay.startup();\n\n        this.timeFormat = new Select({\n          options: this._timeFormatOptions\n        }, this.timeFormat);\n\n        this.inherited(arguments);\n      },\n\n      startup: function () {\n        if (!this.config) {\n          this.config = {};\n        }\n\n        this.customDateFormat.setAttribute(\"placeHolder\", \"YYYY-MM-dd h:m:s Z\");\n\n        this.own(on(this.timeFormat, \"click\", lang.hitch(this, function () {\n          if (\"undefined\" === typeof this._firstChange) {\n            this._firstChange = false;\n          }\n        })));\n        this.own(on(this.timeFormat, 'change', lang.hitch(this, function (val) {\n          if (\"undefined\" === typeof this._firstChange) {\n            this._firstChange = false;\n          } else {\n            this._initOptionsUI(val);\n          }\n        })));\n\n        this.own(on(this.webMapSettingRaido, 'change', lang.hitch(this, function () {\n          this._updateTimeSettingBtnUI();\n        })));\n        this.own(on(this.configureSettingRaido, 'change', lang.hitch(this, function () {\n          this._updateTimeSettingBtnUI();\n        })));\n\n        // this.autoRefresh = new AutoRefresh({\n        //   nls: this.nls,\n        //   map: this.map,\n        //   config: this.config\n        // }, this.autoRefreshContainer);\n\n        this.setConfig(this.config);\n        this.inherited(arguments);\n      },\n\n      _initOptionsUI: function (val, customDateFormatVal) {\n        if (val !== \"Custom\") {\n          html.addClass(this.customDateContainer, \"hide\");\n          this.customDateFormat.set(\"value\", \"\");\n        } else {\n          html.removeClass(this.customDateContainer, \"hide\");\n          this.customDateFormat.set(\"value\", customDateFormatVal || \"\");\n        }\n\n        //popup\n        this.own(on(this.timeSettingBtn, 'click', lang.hitch(this, function () {\n          if (!this.configureSettingRaido.checked) {\n            return;\n          }\n\n          this._createTimeConfigSetting().then(lang.hitch(this, function (isDisableOk) {\n            this.popup = new Popup({\n              titleLabel: this.nls.timeSetting,\n              autoHeight: true,\n              content: this.configureTimeSettings,\n              container: 'main-page',\n              width: 680,\n              buttons: [{\n                label: window.jimuNls.common.ok,\n                key: keys.ENTER,\n                disable: isDisableOk,\n                onClick: lang.hitch(this, '_onPopupOk')\n              }, {\n                label: window.jimuNls.common.cancel,\n                classNames: ['jimu-btn-vacation'],\n                key: keys.ESCAPE\n              }],\n              onClose: lang.hitch(this, '_onPopupClose')\n            });\n            html.addClass(this.popup.domNode, 'timeslider-widget-setting-popup');\n          }));\n        })));\n      },\n\n      _onPopupOk: function () {\n        if (false === this.configureTimeSettings.isValid()) {\n          return false;//prevent closing popup\n        }\n        this.config = this.configureTimeSettings.getConfig(this.config);\n\n        this.popup.close();\n        this.configureTimeSettings = null;\n        this.popup = null;\n      },\n\n      _onPopupClose: function () {\n        this.configureTimeSettings = null;\n        this.popup = null;\n      },\n\n      setConfig: function (config) {\n        this.config = config;\n\n        if (config.showLabels) {\n          this.showLabelsBox.setValue(true);\n        } else {\n          this.showLabelsBox.setValue(false);\n        }\n\n        if (false === config.autoPlay) {\n          this.autoPlay.setValue(false);\n        } else {\n          this.autoPlay.setValue(true);//undefined OR true\n        }\n\n        if (false === config.loopPlay) {\n          this.loopPlay.setValue(false);\n        } else {\n          this.loopPlay.setValue(true);//undefined OR true\n        }\n\n        if (config.timeFormat) {\n          this.timeFormat.setValue(config.timeFormat);\n\n          var customDateFormatValue;\n          if (config.customDateFormat) {\n            customDateFormatValue = config.customDateFormat;\n          }\n          this._initOptionsUI(config.timeFormat, customDateFormatValue);\n        } else {\n          this.timeFormat.setValue(\"auto\");\n        }\n\n        // if (config.autoRefresh) {\n        //   this.autoRefresh.setConfig(config.autoRefresh);\n        // }\n\n        if (\"undefined\" === typeof config.isHonorWebMap || true === config.isHonorWebMap) {\n          config.isHonorWebMap = true;\n          this.webMapSettingRaido.setChecked(true);\n        } else {\n          config.isHonorWebMap = false;\n          this.configureSettingRaido.setChecked(true);\n        }\n        this._updateTimeSettingBtnUI();\n      },\n\n      getConfig: function () {\n        if (\"Custom\" === this.timeFormat.getValue() && \"\" === this.customDateFormat.get(\"value\")) {\n          this.customDateFormat.focus();\n          this.customDateFormat.set(\"state\", \"Error\");\n          return false;\n        }\n\n        this.config.showLabels = this.showLabelsBox.getValue();\n        this.config.autoPlay = this.autoPlay.getValue();\n        this.config.loopPlay = this.loopPlay.getValue();\n        this.config.timeFormat = this.timeFormat.getValue();\n\n        if (this.customDateFormat.get(\"value\")) {\n          this.config.customDateFormat = this.customDateFormat.get(\"value\");\n        } else {\n          this.config.customDateFormat = \"\";\n        }\n\n        // if (this.autoRefresh) {\n        //   this.config.autoRefresh = this.autoRefresh.getConfig();\n        // }\n\n        if (this.webMapSettingRaido.checked) {\n          this.config.isHonorWebMap = true;\n        } else {// this.configureSettingRaido.checked = true;\n          this.config.isHonorWebMap = false;\n        }\n\n        if (!this.configureTimeSettings) {\n          this._createTimeConfigSetting();\n        }\n        if (this.configureTimeSettings && this.configureTimeSettings.getConfig) {\n          this.config = this.configureTimeSettings.getConfig(this.config);\n        }\n\n        return this.config;\n      },\n\n      _onCustomDateFormatBlur: function () {\n        this.customDateFormat.value = jimuUtils.stripHTML(this.customDateFormat.value || \"\");\n      },\n      _updateTimeSettingBtnUI: function () {\n        if (this.webMapSettingRaido.checked) {\n          html.addClass(this.timeSettingBtn, \"disabled\");\n        }\n        if (this.configureSettingRaido.checked) {\n          html.removeClass(this.timeSettingBtn, \"disabled\");\n        }\n      },\n      //popup will destroy that DOM, so need to recreate\n      _createTimeConfigSetting: function () {\n        var def = new Deferred();\n        this.configureTimeSettings = new ConfigureTimeSettings({\n          nls: this.nls,\n          map: this.map,\n          config: this.config\n        }, this.configureTimeSettingsContainer);\n        this.own(on(this.configureTimeSettings, \"initedLayers\", lang.hitch(this, function (ops) {\n          var isDisableOk = false;\n          if (ops && ops.isNoLayer) {\n            isDisableOk = true;\n          }\n\n          def.resolve(isDisableOk);\n        })));\n        this.configureTimeSettings.startup();\n\n        return def;\n      }\n    });\n  });"]}